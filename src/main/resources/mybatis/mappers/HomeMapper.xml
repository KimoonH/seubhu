<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="store.seub2hu2.home.HomeMapper">


    <!-- 주간 베스트 상품 - 별점 순으로 조회 -->
    <select id="getWeeklyBestProductsByRating" resultType="store.seub2hu2.product.dto.ProdListDto">
        SELECT PROD_NO,
               PROD_NAME,
               PROD_PRICE,
               PROD_RATING,
               PROD_IMG_THUM,
               PROD_CNT
        FROM PRODUCTS
        WHERE PROD_STATUS = '판매중'
          AND PROD_CREATED_AT BETWEEN CURDATE() - INTERVAL 7 DAY
          AND CURDATE()
        ORDER BY
            PROD_RATING DESC
    </select>

    <!-- 주간 베스트 상품 - 조회수 순으로 조회 (러닝화 기준) -->
    <select id="getWeeklyBestProductsByViewCount" resultType="store.seub2hu2.product.dto.ProdListDto">
        SELECT PROD_NO, PROD_NAME, PROD_PRICE, PROD_RATING, PROD_IMG_THUM, PROD_CNT
        FROM PRODUCTS
        WHERE PROD_STATUS = '판매중'
        AND CAT_NO = 11  <!-- 러닝화 카테고리 -->
        AND PROD_CREATED_AT BETWEEN CURDATE() - INTERVAL 7 DAY
        AND CURDATE()
        ORDER BY
        PROD_CNT DESC
    </select>

    <select id="getTopViewedBoards" resultType="store.seub2hu2.community.vo.Board">
        SELECT
        B.BOARD_NO        AS no,
        B.BOARD_TITLE           AS title,
        U.USER_NICKNAME   AS "user.nickname", -- 작성자 닉네임
        B.BOARD_CREATED_DATE    AS createdDate,
        B.BOARD_VIEW_CNT        AS viewCnt
        FROM BOARDS B
            LEFT JOIN USERS U ON B.USER_NO = U.USER_NO
        WHERE B.IS_DELETED = 'N'
        ORDER BY B.BOARD_VIEW_CNT DESC
            LIMIT 3
    </select>



</mapper>