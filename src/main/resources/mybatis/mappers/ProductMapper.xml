<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="store.seub2hu2.product.mapper.ProductMapper">

    <select id="getProductByCatNo" resultType="store.seub2hu2.product.vo.Product">

    </select>

    <!--
        List<Product> getProducts();
    -->
    <resultMap id="productWithImgMap" type="store.seub2hu2.product.dto.ProdListDto" >
        <id property="no" column="PROD_NO"/>
        <result property="name" column="PROD_NAME"/>
        <result property="price" column="PROD_PRICE"/>
        <result property="status" column="PROD_STATUS" />
        <association property="category" javaType="store.seub2hu2.product.vo.Category">
            <id property="no" column="CAT_NO"/>
            <result property="name" column="CAT_NAME" />
            <result property="topNo" column="CAT_TOP_NO"/>
        </association>
        <collection property="images" ofType="store.seub2hu2.product.vo.Image">
            <id property="no" column="IMG_NO" />
            <result property="url" column="IMG_URL" />
        </collection>
    </resultMap>
    <select id="getProducts" resultMap="productWithImgMap">
        SELECT P.PROD_NO,
            P.PROD_NAME,
            P.PROD_PRICE,
            P.PROD_STATUS,
            PC.CAT_NAME,
            PI.IMG_URL
        FROM PRODUCTS P
            JOIN PROD_CATEGORIES PC ON P.CAT_NO = PC.CAT_NO
            JOIN PROD_IMGS PI ON P.PROD_NO = PI.PROD_NO
        WHERE PI.IMG_THUM = 'Y';
    </select>


</mapper>